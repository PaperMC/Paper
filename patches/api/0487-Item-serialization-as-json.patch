From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: masmc05 <masmc05@gmail.com>
Date: Sun, 11 Aug 2024 03:01:52 +0300
Subject: [PATCH] Item serialization as json


diff --git a/src/main/java/org/bukkit/UnsafeValues.java b/src/main/java/org/bukkit/UnsafeValues.java
index 330e3013eda204aa9b33d5e1c3104e0b595abdbc..da24415c7764b62d26c1b57efc14813ef93bdd5e 100644
--- a/src/main/java/org/bukkit/UnsafeValues.java
+++ b/src/main/java/org/bukkit/UnsafeValues.java
@@ -259,6 +259,29 @@ public interface UnsafeValues {
     void setBiomeKey(RegionAccessor accessor, int x, int y, int z, NamespacedKey biomeKey);
     // Paper end - namespaced key biome methods
 
+    // Paper start - Item serialization to json
+    /**
+     * Creates an itemstack from a json object.
+     *
+     * This expects that the DataVersion was stored on the root of the Json Object, as saved from
+     * the {@link #serializeAsJson(ItemStack)} API returned.
+     * @param data object representing an item in Json format
+     * @return ItemStack migrated to this version of Minecraft if needed.
+     * @throws IllegalArgumentException if the json object is not a valid item
+     * @see #serializeAsJson(ItemStack)
+     */
+    @NotNull ItemStack createItemStack(@NotNull com.google.gson.JsonObject data) throws IllegalArgumentException;
+
+    /**
+     * Serializes this itemstack to vanilla compatible json format. It is safe for data migrations as it will
+     * use the built in data converter instead of bukkits dangerous serialization system.
+     * @return json object representing this item.
+     * @see #createItemStack(com.google.gson.JsonObject)
+     */
+    @NotNull
+    com.google.gson.JsonObject serializeAsJson(@NotNull ItemStack itemStack);
+    // Paper end - Item serialization to json
+
     String getStatisticCriteriaKey(@NotNull org.bukkit.Statistic statistic); // Paper - fix custom stats criteria creation
 
     // Paper start - spawn egg color visibility
