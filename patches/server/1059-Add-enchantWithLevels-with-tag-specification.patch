From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: masmc05 <masmc05@gmail.com>
Date: Wed, 25 Sep 2024 16:26:04 +0300
Subject: [PATCH] Add enchantWithLevels with tag specification


diff --git a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemFactory.java b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemFactory.java
index db08f072609dcb76388dcf402df214eeb32a292b..b8887cc26e04f34201004d1cad9868de29718402 100644
--- a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemFactory.java
+++ b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemFactory.java
@@ -319,6 +319,22 @@ public final class CraftItemFactory implements ItemFactory {
         );
     }
 
+    @Override
+    public ItemStack enchantWithLevels(ItemStack itemStack, int levels, io.papermc.paper.registry.set.RegistryKeySet<org.bukkit.enchantments.Enchantment> keySet, java.util.Random random) {
+        return enchantWithLevels(
+            itemStack,
+            levels,
+            keySet == null ? Optional.empty() : Optional.of(
+                io.papermc.paper.registry.set.PaperRegistrySets.convertToNms(
+                    Registries.ENCHANTMENT,
+                    net.minecraft.server.MinecraftServer.getServer().registryAccess().createSerializationContext(net.minecraft.nbt.NbtOps.INSTANCE).lookupProvider,
+                    keySet
+                )
+            ),
+            random
+        );
+    }
+
     @SuppressWarnings("OptionalUsedAsFieldOrParameterType")
     private ItemStack enchantWithLevels(
         ItemStack itemStack,
