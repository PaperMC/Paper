From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Tamion <70228790+notTamion@users.noreply.github.com>
Date: Sun, 11 Feb 2024 08:49:30 +0100
Subject: [PATCH] Add RayTraceConfiguration


diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index f2b20ed5063a293f0b464548f590d652170cd1d8..b1290a02d06927209c3a25a10be7a34e944eac86 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -1306,6 +1306,19 @@ public class CraftWorld extends CraftRegionAccessor implements World {
         return blockHit;
     }
 
+    // Paper start - Add RayTraceConfiguration
+    @Override
+    public @org.jetbrains.annotations.Nullable RayTraceResult rayTrace(Location start, Vector direction, io.papermc.paper.raytracing.RayTraceConfiguration config) {
+        List<io.papermc.paper.raytracing.RayTraceConfiguration.Targets> targets = config.targets();
+        if (targets.contains(io.papermc.paper.raytracing.RayTraceConfiguration.Targets.ENTITIES)) {
+            if(targets.contains(io.papermc.paper.raytracing.RayTraceConfiguration.Targets.BLOCKS))
+                return this.rayTrace(start, direction, config.maxDistance(), config.fluidCollisionMode(), config.ignorePassableBlocks(), config.raySize(), config.entityFilter(), config.blockFilter());
+            return this.rayTraceEntities(start, direction, config.maxDistance(), config.raySize(), config.entityFilter());
+        }
+        return this.rayTraceBlocks(start, direction, config.maxDistance(), config.fluidCollisionMode(), config.ignorePassableBlocks(), config.blockFilter());
+    }
+    // Paper end - Add RayTraceConfiguration
+
     @Override
     public List<Player> getPlayers() {
         List<Player> list = new ArrayList<Player>(this.world.players().size());
