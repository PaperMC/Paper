From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Chaosdave34 <david.emanuel@gmx.de>
Date: Tue, 26 Nov 2024 17:11:23 +0100
Subject: [PATCH] Call PlayerUseBowWithoutProjectileEvent in
 Player#getProjectile


diff --git a/src/main/java/net/minecraft/world/entity/player/Player.java b/src/main/java/net/minecraft/world/entity/player/Player.java
index 61d412c4f1ebd55661cc3f0260468e3ac0efe0bb..6cf27e4e95b6b73212236ce739dc2514ea8dbab4 100644
--- a/src/main/java/net/minecraft/world/entity/player/Player.java
+++ b/src/main/java/net/minecraft/world/entity/player/Player.java
@@ -2266,7 +2266,15 @@ public abstract class Player extends LivingEntity {
                     }
                 }
 
-                return this.abilities.instabuild ? new ItemStack(Items.ARROW) : ItemStack.EMPTY;
+                // Paper start - Call PlayerUseBowWithoutProjectileEvent in Player#getProjectile
+                if (this.abilities.instabuild) {
+                    return new ItemStack(Items.ARROW);
+                } else {
+                    io.papermc.paper.event.player.PlayerUseBowWithoutProjectileEvent event = new io.papermc.paper.event.player.PlayerUseBowWithoutProjectileEvent((org.bukkit.entity.Player) getBukkitEntity(), org.bukkit.craftbukkit.inventory.CraftItemStack.asBukkitCopy(stack));
+                    event.callEvent();
+                    return org.bukkit.craftbukkit.inventory.CraftItemStack.asNMSCopy(event.getProjectile());
+                }
+                // Paper end - Call PlayerUseBowWithoutProjectileEvent in Player#getProjectile
             }
         }
     }
