From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: TrollyLoki <trollyloki@gmail.com>
Date: Wed, 11 Oct 2023 00:45:53 -0400
Subject: [PATCH] Add API to get the collision shape of a block before it's
 placed


diff --git a/src/main/java/org/bukkit/craftbukkit/block/data/CraftBlockData.java b/src/main/java/org/bukkit/craftbukkit/block/data/CraftBlockData.java
index 28a798e497c2c12794169068e69b56dd954978f3..7b4086240fad7eb3ef8eed9eb94ffeb79308e3da 100644
--- a/src/main/java/org/bukkit/craftbukkit/block/data/CraftBlockData.java
+++ b/src/main/java/org/bukkit/craftbukkit/block/data/CraftBlockData.java
@@ -676,6 +676,20 @@ public class CraftBlockData implements BlockData {
         return this.state.isFaceSturdy(EmptyBlockGetter.INSTANCE, BlockPos.ZERO, CraftBlock.blockFaceToNotch(face), CraftBlockSupport.toNMS(support));
     }
 
+    // Paper start
+    @Override
+    public org.bukkit.util.VoxelShape getCollisionShape(Location location) {
+        Preconditions.checkArgument(location != null, "location must not be null");
+
+        CraftWorld world = (CraftWorld) location.getWorld();
+        Preconditions.checkArgument(world != null, "location must not have a null world");
+
+        BlockPos position = CraftLocation.toBlockPosition(location);
+        net.minecraft.world.phys.shapes.VoxelShape shape = this.state.getCollisionShape(world.getHandle(), position);
+        return new org.bukkit.craftbukkit.util.CraftVoxelShape(shape);
+    }
+    // Paper end
+
     @Override
     public Material getPlacementMaterial() {
         return CraftMagicNumbers.getMaterial(this.state.getBlock().asItem());
