From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: masmc05 <masmc05@gmail.com>
Date: Sat, 5 Oct 2024 04:23:13 +0300
Subject: [PATCH] Add ItemStack#effectiveName


diff --git a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
index f84e07fa0876bb6da0f99f4de6cb811f897adca2..e2191bc42951760b67e475e50be38c6abb3a77b7 100644
--- a/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
+++ b/src/main/java/org/bukkit/craftbukkit/inventory/CraftItemStack.java
@@ -22,6 +22,7 @@ import org.bukkit.inventory.ItemStack;
 import org.bukkit.inventory.meta.ItemMeta;
 import org.bukkit.material.MaterialData;
 import org.jetbrains.annotations.ApiStatus;
+import org.jetbrains.annotations.NotNull;
 
 @DelegateDeserialization(ItemStack.class)
 public final class CraftItemStack extends ItemStack {
@@ -438,6 +439,23 @@ public final class CraftItemStack extends ItemStack {
         return true;
     }
 
+    // Paper start - add ItemStack#effectiveName
+    @Override
+    public @NotNull net.kyori.adventure.text.Component effectiveName() {
+        // 1.21.2: return this.handle == null ? net.kyori.adventure.text.Component.empty() : io.papermc.paper.adventure.PaperAdventure.asAdventure(this.handle.getStyledHoverName());
+        if (this.handle == null) {
+            return net.kyori.adventure.text.Component.empty();
+        }
+        net.kyori.adventure.text.Component hover = io.papermc.paper.adventure.PaperAdventure.asAdventure(this.handle.getHoverName());
+        net.kyori.adventure.text.format.Style.Builder style = hover.style().toBuilder();
+        style.color(io.papermc.paper.adventure.PaperAdventure.asAdventure(this.handle.getRarity().color()));
+        if (this.handle.has(DataComponents.CUSTOM_NAME)) {
+            style.decoration(net.kyori.adventure.text.format.TextDecoration.ITALIC, true);
+        }
+        return hover.style(style);
+    }
+    // Paper end - add ItemStack#effectiveName
+
     @Override
     public boolean isSimilar(ItemStack stack) {
         if (stack == null) {
