--- a/net/minecraft/world/level/storage/loot/functions/ExplorationMapFunction.java
+++ b/net/minecraft/world/level/storage/loot/functions/ExplorationMapFunction.java
@@ -83,9 +_,17 @@
             Vec3 lootPos = context.getOptionalParameter(LootContextParams.ORIGIN);
             if (lootPos != null) {
                 ServerLevel level = context.getLevel();
+                // Paper start - Configurable cartographer treasure maps
+                if (!level.paperConfig().environment.treasureMaps.enabled) {
+                    /*
+                     * NOTE: I fear users will just get a plain map as their "treasure"
+                     * This is preferable to disrespecting the config.
+                     */
+                    return itemStack;
+                }
+                // Paper end - Configurable cartographer treasure maps
                 BlockPos nearestMapStructure = level.findNearestMapStructure(
-                    this.destination, BlockPos.containing(lootPos), this.searchRadius, this.skipKnownStructures
-                );
+                    this.destination, BlockPos.containing(lootPos), this.searchRadius, !level.paperConfig().environment.treasureMaps.findAlreadyDiscoveredLootTable.or(!this.skipKnownStructures)); // Paper - Configurable cartographer treasure maps
                 if (nearestMapStructure != null) {
                     ItemStack map = MapItem.create(level, nearestMapStructure.getX(), nearestMapStructure.getZ(), this.zoom, true, true);
                     MapItem.renderBiomePreviewMap(level, map);
