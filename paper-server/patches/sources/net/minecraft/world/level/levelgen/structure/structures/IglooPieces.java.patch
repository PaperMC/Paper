--- a/net/minecraft/world/level/levelgen/structure/structures/IglooPieces.java
+++ b/net/minecraft/world/level/levelgen/structure/structures/IglooPieces.java
@@ -115,10 +_,13 @@
         ) {
             if ("chest".equals(markerId)) {
                 level.setBlock(position, Blocks.AIR.defaultBlockState(), Block.UPDATE_ALL);
-                BlockEntity chest = level.getBlockEntity(position.below());
-                if (chest instanceof ChestBlockEntity) {
-                    ((ChestBlockEntity)chest).setLootTable(BuiltInLootTables.IGLOO_CHEST, random.nextLong());
-                }
+                // CraftBukkit start - ensure block transformation
+                // BlockEntity blockEntity = level.getBlockEntity(position.below());
+                // if (blockEntity instanceof ChestBlockEntity) {
+                //     ((ChestBlockEntity)blockEntity).setLootTable(BuiltInLootTables.IGLOO_CHEST, random.nextLong());
+                // }
+                this.setCraftLootTable(level, position.below(), random, BuiltInLootTables.IGLOO_CHEST);
+                // CraftBukkit end
             }
         }
 
