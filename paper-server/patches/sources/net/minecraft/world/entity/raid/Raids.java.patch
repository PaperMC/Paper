--- a/net/minecraft/world/entity/raid/Raids.java
+++ b/net/minecraft/world/entity/raid/Raids.java
@@ -52,6 +_,7 @@
     private Raids(final List<Raids.RaidWithId> raids, final int nextId, final int tick) {
         for (Raids.RaidWithId raid : raids) {
             this.raidMap.put(raid.id, raid.raid);
+            raidWithId.raid.idOrNegativeOne = raidWithId.id; // Paper - expose id of raids while method is kept around as deprecated for removal
         }
 
         this.nextId = nextId;
@@ -130,11 +_,23 @@
                 }
 
                 Raid raid = this.getOrCreateRaid(level, raidCenterPos);
-                if (!raid.isStarted() && !this.raidMap.containsValue(raid)) {
-                    this.raidMap.put(this.getUniqueId(), raid);
-                }
-
-                if (!raid.isStarted() || raid.getRaidOmenLevel() < raid.getMaxRaidOmenLevel()) {
+                // CraftBukkit - moved down
+                // if (!raid.isStarted() && !this.raidMap.containsValue(raid)) {
+                //     this.raidMap.put(this.getUniqueId(), raid);
+                // }
+
+                if (!raid.isStarted() || (raid.isInProgress() && raid.getRaidOmenLevel() < raid.getMaxRaidOmenLevel())) { // CraftBukkit - fixed a bug with raid: players could add up Bad Omen level even when the raid had finished
+                    // CraftBukkit start
+                    if (!org.bukkit.craftbukkit.event.CraftEventFactory.callRaidTriggerEvent(serverLevel, raid, player)) {
+                        player.removeEffect(net.minecraft.world.effect.MobEffects.RAID_OMEN);
+                        return null;
+                    }
+
+                    if (!raid.isStarted() && !this.raidMap.containsValue(raid)) {
+                        this.raidMap.put(this.getUniqueId(), raid);
+                        raid.idOrNegativeOne = this.nextId; // Paper - expose id of raids while method is kept around as deprecated for removal
+                    }
+                    // CraftBukkit end
                     raid.absorbRaidOmen(player);
                 }
 
