From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/gametest/framework/GameTestServer.java b/net/minecraft/gametest/framework/GameTestServer.java
index 0907ee5d2c5adf0a54e140a6aebe32bd2d4ec011..586ab84d95ac1b04a8b269ed63e6e4399fef64e2 100644
--- a/net/minecraft/gametest/framework/GameTestServer.java
+++ b/net/minecraft/gametest/framework/GameTestServer.java
@@ -146,6 +146,8 @@ public class GameTestServer extends MinecraftServer {
         boolean verify
     ) {
         super(
+            null, // Paper
+            null, // Paper
             serverThread,
             storageSource,
             packRepository,
@@ -161,9 +163,17 @@ public class GameTestServer extends MinecraftServer {
 
     @Override
     public boolean initServer() {
-        this.setPlayerList(new PlayerList(this, this.registries(), this.playerDataStorage, new EmptyNotificationService()) {});
+        // Paper start
+        this.setPlayerList(new PlayerList(this, this.registries(), this.playerDataStorage, new EmptyNotificationService()) {
+            @Override
+            public void loadAndSaveFiles() {
+                throw new UnsupportedOperationException("Should not be called in a GameTestServer");
+            }
+        });
+        this.initPostWorld();
         Gizmos.withCollector(GizmoCollector.NOOP);
-        this.loadLevel();
+        this.loadLevel("blah");
+        // Paper end
         ServerLevel serverLevel = this.overworld();
         this.testBatches = this.evaluateTestsToRun(serverLevel);
         LOGGER.info("Started game test server");
@@ -348,6 +358,13 @@ public class GameTestServer extends MinecraftServer {
         return false;
     }
 
+    // Paper start
+    @Override
+    public org.bukkit.command.CommandSender getBukkitSender(final net.minecraft.commands.CommandSourceStack wrapper) {
+        throw new UnsupportedOperationException("Not supported.");
+    }
+    // Paper end
+
     @Override
     public boolean isSingleplayerOwner(NameAndId nameAndId) {
         return false;
@@ -395,5 +412,16 @@ public class GameTestServer extends MinecraftServer {
         @Override
         public void save() {
         }
+
+        // Paper start
+        @Override
+        public void save(final boolean async) {
+        }
+
+        @Override
+        public @Nullable NameAndId getIfCached(final String name) {
+            return this.get(name).orElse(null);
+        }
+        // Paper end
     }
 }
