From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/world/level/storage/DimensionDataStorage.java b/net/minecraft/world/level/storage/DimensionDataStorage.java
index 1ee0657bca3afe79994d6c7ad471e4490a84d97d..b932e6236975fd4a755bdbf4b7a958599383f3f8 100644
--- a/net/minecraft/world/level/storage/DimensionDataStorage.java
+++ b/net/minecraft/world/level/storage/DimensionDataStorage.java
@@ -145,7 +145,7 @@ public class DimensionDataStorage implements AutoCloseable {
         } else {
             int i = Util.maxAllowedExecutorThreads();
             int size = map.size();
-            if (size > i) {
+            if (false && size > i) { // Paper - Separate dimension data IO pool; just throw them into the fixed pool queue
                 this.pendingWriteFuture = this.pendingWriteFuture.thenCompose(object -> {
                     List<CompletableFuture<?>> list = new ArrayList<>(i);
                     int i1 = Mth.positiveCeilDiv(size, i);
@@ -166,7 +166,7 @@ public class DimensionDataStorage implements AutoCloseable {
                         object -> CompletableFuture.allOf(
                             map.entrySet()
                                 .stream()
-                                .map(entry -> CompletableFuture.runAsync(() -> this.tryWrite(entry.getKey(), entry.getValue()), Util.ioPool()))
+                                .map(entry -> CompletableFuture.runAsync(() -> this.tryWrite(entry.getKey(), entry.getValue()), Util.DIMENSION_DATA_IO_POOL)) // Paper - Separate dimension data IO pool
                                 .toArray(CompletableFuture[]::new)
                         )
                     );
