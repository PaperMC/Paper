From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/world/level/block/entity/SculkShriekerBlockEntity.java b/net/minecraft/world/level/block/entity/SculkShriekerBlockEntity.java
index 8a45ebd90e96dfa8f227b6a97a1011426e971cd7..8a999d8e72b306d1e4a371c7a43cdf6e5b13daff 100644
--- a/net/minecraft/world/level/block/entity/SculkShriekerBlockEntity.java
+++ b/net/minecraft/world/level/block/entity/SculkShriekerBlockEntity.java
@@ -87,6 +87,13 @@ public class SculkShriekerBlockEntity extends BlockEntity implements GameEventLi
     }
 
     public static @Nullable ServerPlayer tryGetPlayer(@Nullable Entity entity) {
+    // Paper start - check global player list where appropriate; ensure level is the same for sculk events
+        final ServerPlayer player = tryGetPlayer0(entity);
+        return player != null && player.level() == entity.level() ? player : null;
+    }
+    @Nullable
+    private static ServerPlayer tryGetPlayer0(@Nullable Entity entity) {
+    // Paper end - check global player list where appropriate
         if (entity instanceof ServerPlayer serverPlayer) {
             return serverPlayer;
         } else if (entity != null && entity.getControllingPassenger() instanceof ServerPlayer serverPlayer) {
@@ -162,7 +169,7 @@ public class SculkShriekerBlockEntity extends BlockEntity implements GameEventLi
     private boolean trySummonWarden(ServerLevel level) {
         return this.warningLevel >= 4
             && SpawnUtil.trySpawnMob(
-                    EntityType.WARDEN, EntitySpawnReason.TRIGGERED, level, this.getBlockPos(), 20, 5, 6, SpawnUtil.Strategy.ON_TOP_OF_COLLIDER, false
+                    EntityType.WARDEN, EntitySpawnReason.TRIGGERED, level, this.getBlockPos(), 20, 5, 6, SpawnUtil.Strategy.ON_TOP_OF_COLLIDER, false, org.bukkit.event.entity.CreatureSpawnEvent.SpawnReason.NATURAL, null // Paper - Entity#getEntitySpawnReason
                 )
                 .isPresent();
     }
