From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/world/level/block/MultifaceSpreader.java b/net/minecraft/world/level/block/MultifaceSpreader.java
index 83130680391305de1b284125d39e0d01a99ef743..c856a2d2d56f78805f02c3bbb551cedfa040df7e 100644
--- a/net/minecraft/world/level/block/MultifaceSpreader.java
+++ b/net/minecraft/world/level/block/MultifaceSpreader.java
@@ -152,14 +152,14 @@ public class MultifaceSpreader {
                     level.getChunk(pos.pos()).markPosForPostprocessing(pos.pos());
                 }
 
-                return level.setBlock(pos.pos(), stateForPlacement, Block.UPDATE_CLIENTS);
+                return org.bukkit.craftbukkit.event.CraftEventFactory.handleBlockSpreadEvent(level, pos.source(), pos.pos(), stateForPlacement, Block.UPDATE_CLIENTS, true); // CraftBukkit
             } else {
                 return false;
             }
         }
     }
 
-    public record SpreadPos(BlockPos pos, Direction face) {
+    public record SpreadPos(BlockPos pos, Direction face, BlockPos source) { // CraftBukkit
     }
 
     @FunctionalInterface
@@ -171,19 +171,19 @@ public class MultifaceSpreader {
         SAME_POSITION {
             @Override
             public MultifaceSpreader.SpreadPos getSpreadPos(BlockPos pos, Direction face, Direction spreadDirection) {
-                return new MultifaceSpreader.SpreadPos(pos, face);
+                return new MultifaceSpreader.SpreadPos(pos, face, pos); // CraftBukkit
             }
         },
         SAME_PLANE {
             @Override
             public MultifaceSpreader.SpreadPos getSpreadPos(BlockPos pos, Direction face, Direction spreadDirection) {
-                return new MultifaceSpreader.SpreadPos(pos.relative(face), spreadDirection);
+                return new MultifaceSpreader.SpreadPos(pos.relative(face), spreadDirection, pos); // CraftBukkit
             }
         },
         WRAP_AROUND {
             @Override
             public MultifaceSpreader.SpreadPos getSpreadPos(BlockPos pos, Direction face, Direction spreadDirection) {
-                return new MultifaceSpreader.SpreadPos(pos.relative(face).relative(spreadDirection), face.getOpposite());
+                return new MultifaceSpreader.SpreadPos(pos.relative(face).relative(spreadDirection), face.getOpposite(), pos); // CraftBukkit
             }
         };
 
