From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/world/entity/animal/armadillo/Armadillo.java b/net/minecraft/world/entity/animal/armadillo/Armadillo.java
index da7049e6f79134f06bf6b455d46cf483c8024a28..901e4e9897e76cd4158d7f8bb8ec829df8ff8196 100644
--- a/net/minecraft/world/entity/animal/armadillo/Armadillo.java
+++ b/net/minecraft/world/entity/animal/armadillo/Armadillo.java
@@ -137,10 +137,12 @@ public class Armadillo extends Animal {
         ArmadilloAi.updateActivity(this);
         profilerFiller.pop();
         if (this.isAlive() && --this.scuteTime <= 0 && this.shouldDropLoot(level)) {
+            this.forceDrops = true; // CraftBukkit
             if (this.dropFromGiftLootTable(level, BuiltInLootTables.ARMADILLO_SHED, this::spawnAtLocation)) {
                 this.playSound(SoundEvents.ARMADILLO_SCUTE_DROP, 1.0F, (this.random.nextFloat() - this.random.nextFloat()) * 0.2F + 1.0F);
                 this.gameEvent(GameEvent.ENTITY_PLACE);
             }
+            this.forceDrops = false; // CraftBukkit
 
             this.scuteTime = this.pickNextScuteDropTime();
         }
@@ -277,8 +279,11 @@ public class Armadillo extends Animal {
     }
 
     @Override
-    protected void actuallyHurt(ServerLevel level, DamageSource damageSource, float amount) {
-        super.actuallyHurt(level, damageSource, amount);
+    // CraftBukkit start - void -> boolean
+    public boolean actuallyHurt(ServerLevel level, DamageSource damageSource, float amount, org.bukkit.event.entity.EntityDamageEvent event) {
+        boolean damageResult = super.actuallyHurt(level, damageSource, amount, event);
+        if (!damageResult) return false;
+        // CraftBukkit end
         if (!this.isNoAi() && !this.isDeadOrDying()) {
             if (damageSource.getEntity() instanceof LivingEntity) {
                 this.getBrain().setMemoryWithExpiry(MemoryModuleType.DANGER_DETECTED_RECENTLY, true, 80L);
@@ -289,6 +294,7 @@ public class Armadillo extends Animal {
                 this.rollOut();
             }
         }
+        return true; // CraftBukkit
     }
 
     @Override
@@ -307,7 +313,9 @@ public class Armadillo extends Animal {
             return false;
         } else {
             if (this.level() instanceof ServerLevel serverLevel) {
+                this.forceDrops = true; // CraftBukkit
                 this.dropFromEntityInteractLootTable(serverLevel, BuiltInLootTables.ARMADILLO_BRUSH, entity, stack, this::spawnAtLocation);
+                this.forceDrops = false; // CraftBukkit
                 this.playSound(SoundEvents.ARMADILLO_BRUSH);
                 this.gameEvent(GameEvent.ENTITY_INTERACT);
             }
