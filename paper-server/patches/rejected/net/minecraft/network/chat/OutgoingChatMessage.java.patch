From c8366d72279d30331daff185f7b263159a86ff4d Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/network/chat/OutgoingChatMessage.java b/net/minecraft/network/chat/OutgoingChatMessage.java
index 0085569f33e7aa1061262b9f0ff3f7bea9584c40..30b26c6def2f6cb8d742ae3eeb9a7c2cd672991c 100644
--- a/net/minecraft/network/chat/OutgoingChatMessage.java
+++ b/net/minecraft/network/chat/OutgoingChatMessage.java
@@ -7,6 +7,12 @@ public interface OutgoingChatMessage {
 
     void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType);
 
+    // Paper start
+    default void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType, @javax.annotation.Nullable Component unsigned) {
+        this.sendToPlayer(player, filtered, boundChatType);
+    }
+    // Paper end
+
     static OutgoingChatMessage create(PlayerChatMessage message) {
         return (OutgoingChatMessage)(message.isSystem()
             ? new OutgoingChatMessage.Disguised(message.decoratedContent())
@@ -16,7 +22,13 @@ public interface OutgoingChatMessage {
     public record Disguised(@Override Component content) implements OutgoingChatMessage {
         @Override
         public void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType) {
-            player.connection.sendDisguisedChatMessage(this.content, boundChatType);
+            // Paper start
+            this.sendToPlayer(player, filtered, boundChatType, null);
+        }
+        @Override
+        public void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType, @javax.annotation.Nullable Component unsigned) {
+            player.connection.sendDisguisedChatMessage(unsigned != null ? unsigned : this.content, boundChatType);
+            // Paper end
         }
     }
 
@@ -28,7 +40,14 @@ public interface OutgoingChatMessage {
 
         @Override
         public void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType) {
+            // Paper start
+            this.sendToPlayer(player, filtered, boundChatType, null);
+        }
+        @Override
+        public void sendToPlayer(ServerPlayer player, boolean filtered, ChatType.Bound boundChatType, @javax.annotation.Nullable Component unsigned) {
+            // Paper end
             PlayerChatMessage playerChatMessage = this.message.filter(filtered);
+            playerChatMessage = unsigned != null ? playerChatMessage.withUnsignedContent(unsigned) : playerChatMessage; // Paper
             if (!playerChatMessage.isFullyFiltered()) {
                 player.connection.sendPlayerChatMessage(playerChatMessage, boundChatType);
             }
