From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Lumine1909 <133463833+Lumine1909@users.noreply.github.com>
Date: Sun, 13 Jul 2025 00:04:21 -0700
Subject: [PATCH] Function command event


diff --git a/net/minecraft/commands/execution/tasks/BuildContexts.java b/net/minecraft/commands/execution/tasks/BuildContexts.java
index 569abbea01f585990d2017c68580257275bbb06d..1d0a83e4eb180d7c39818807e33938cf585bb7e4 100644
--- a/net/minecraft/commands/execution/tasks/BuildContexts.java
+++ b/net/minecraft/commands/execution/tasks/BuildContexts.java
@@ -29,7 +29,7 @@ public class BuildContexts<T extends ExecutionCommandSource<T>> {
     public static final DynamicCommandExceptionType ERROR_FORK_LIMIT_REACHED = new DynamicCommandExceptionType(
         forkLimit -> Component.translatableEscape("command.forkLimit", forkLimit)
     );
-    private final String commandInput;
+    protected final String commandInput; // Paper - private -> protected
     private final ContextChain<T> command;
 
     public BuildContexts(String commandInput, ContextChain<T> command) {
@@ -168,6 +168,11 @@ public class BuildContexts<T extends ExecutionCommandSource<T>> {
 
         @Override
         public void execute(T source, ExecutionContext<T> executionContext, Frame frame) {
+            // Paper start - function command event
+            if (!new io.papermc.paper.event.function.FunctionCommandEvent(((net.minecraft.commands.CommandSourceStack) source).getBukkitSender(), this.commandInput).callEvent()) {
+                return;
+            }
+            // Paper end - function command event
             this.traceCommandStart(executionContext, frame);
             this.execute(source, List.of(source), executionContext, frame, ChainModifiers.DEFAULT);
         }
